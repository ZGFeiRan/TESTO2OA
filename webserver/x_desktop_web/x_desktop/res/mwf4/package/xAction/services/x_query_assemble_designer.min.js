MWF.xAction.RestActions.Action["x_query_assemble_designer"]=new Class({Extends:MWF.xAction.RestActions.Action,getUUID:function(i){var e="";this.action.invoke({name:"getId",async:false,parameter:{count:"1"},success:function(a){e=a.data[0].id;if(i)i(e)},failure:null});return e},listApplicationSummary:function(a,i,e,t){if(a){this.action.invoke({name:"listApplicationByCategorySummary",async:t,parameter:{queryCategory:a},success:i,failure:e})}else{this.action.invoke({name:"listApplicationSummary",async:t,success:i,failure:e})}},saveApplication:function(a,i,e){if(a.id){this.updateApplication(a.id,a,i,e)}else{this.addApplication(a,i,e)}},saveView:function(a,i,e){if(!a.isNewView){this.updateView(a,i,e)}else{this.addView(a,i,e)}},updateView:function(a,i,e){var t=a.data;a.data=JSON.encode(a.data);a.query=a.application;a.queryName=a.applicationName;this.action.invoke({name:"updateView",data:a,parameter:{id:a.id},success:i,failure:e});a.data=t},addView:function(i,e,t){var n=i.data;i.data=JSON.encode(i.data);i.query=i.application;i.queryName=i.applicationName;if(!n.id){this.getUUID(function(a){i.id=a;this.action.invoke({name:"addView",data:i,success:function(a){i.isNewView=false;if(e)e(a)},failure:t});i.data=n}.bind(this))}else{this.action.invoke({name:"addView",data:i,success:function(a){i.isNewView=false;if(e)e(a)},failure:t});i.data=n}},saveStat:function(a,i,e){if(!a.isNewView){this.updateStat(a,i,e)}else{this.addStat(a,i,e)}},updateStat:function(a,i,e){var t=a.data;a.data=JSON.encode(a.data);a.query=a.application;a.queryName=a.applicationName;this.action.invoke({name:"updateStat",data:a,parameter:{id:a.id},success:i,failure:e});a.data=t},addStat:function(i,e,t){var n=i.data;i.data=JSON.encode(i.data);i.query=i.application;i.queryName=i.applicationName;if(!n.id){this.getUUID(function(a){i.id=a;this.action.invoke({name:"addStat",data:i,success:function(a){i.isNewView=false;if(e)e(a)},failure:t});i.data=n}.bind(this))}else{this.action.invoke({name:"addView",data:i,success:function(a){i.isNewView=false;if(e)e(a)},failure:t});i.data=n}},deleteView:function(a,i,e,t){this.action.invoke({name:"removeView",async:t,parameter:{id:a},success:i,failure:e})},deleteStat:function(a,i,e,t){this.action.invoke({name:"removeStat",async:t,parameter:{id:a},success:i,failure:e})}});